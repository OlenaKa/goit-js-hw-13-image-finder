{"version":3,"sources":["webpack:///./js/apiService.js","webpack:///./js/finder.js","webpack:///./templates/gallery-item.hbs"],"names":["SearchApiService","this","searchQuery","page","fetchImages","searchRef","BASE_URL","fetch","find","result","json","resetPage","newQuery","basicLightbox","require","error","defaults","searchApiService","PicturesApiService","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","searchPictures","refs","gallery","document","querySelector","input","searchForm","searchBtn","showMoreBtn","scrollFlag","endOfSearch","searchResults","fetchPictures","response","items","hits","push","onFetchResults","undefined","length","stopSearch","classList","remove","add","showErrorAlert","insertAdjacentHTML","galleryItemTemplate","observe","unobserve","closer","sticker","width","delay","text","addEventListener","e","preventDefault","query","currentTarget","elements","value","innerHTML","target","contains","currentImgSrcObj","webformatURL","getAttribute","create","largeImageURL","tags","show","addBackToTop","backgroundColor","Handlebars","module","exports","template","container","depth0","helpers","partials","data","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop"],"mappings":"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","file":"main.c084ee264db10b1be3fc.js","sourcesContent":["const APY_KEY ='21066802-1751d875d52f6494cef1e0048';\r\nconst BASE_URL = 'https://pixabay.com';\r\n\r\n\r\nexport default class SearchApiService {\r\n  constructor () {\r\n     this.searchQuery = ''; \r\n     this.page = 1;\r\n  }\r\n\r\n  async fetchImages  () {\r\n    const searchRef = `${BASE_URL}/api/?key=${APY_KEY}&q=${this.searchQuery}&image_type=photo&page=${this.page}&per_page=12`;\r\n     \r\n    const find = await fetch(searchRef)\r\n    const result = find.json()\r\n    this.page+=1;\r\n    return result; \r\n  }\r\n\r\n  get query (){\r\n    return this.searchQuery;\r\n  }\r\n\r\n  set query (newQuery) {\r\n    this.searchQuery = newQuery;\r\n  }\r\n\r\n  resetPage () {\r\n    this.page = 1;\r\n  }\r\n}\r\n\r\n","\r\nimport PicturesApiService from './apiService';\r\nimport galleryItemTemplate from '../templates/gallery-item.hbs';\r\nimport { addBackToTop } from 'vanilla-back-to-top';\r\nconst basicLightbox = require('basiclightbox');\r\nconst { error } = require('@pnotify/core');\r\nconst { defaults } = require('@pnotify/core');\r\n\r\n\r\nconst searchApiService = new PicturesApiService();\r\nlet observer = new IntersectionObserver((entries)=>{\r\n  entries.forEach(entry=>{\r\n    if (entry.isIntersecting){\r\n     searchPictures();\r\n    }\r\n  })\r\n});\r\n\r\nconst refs = {\r\n  gallery: document.querySelector ('.my-gallery'),\r\n  input: document.querySelector ('input'),\r\n  searchForm: document.querySelector ('.search-form'),\r\n  searchBtn: document.querySelector('.search'),\r\n  showMoreBtn: document.querySelector('.search'),\r\n  scrollFlag: document.querySelector('.loader-ellips'),\r\n  endOfSearch: document.querySelector('.end-of-search'),\r\n};\r\n\r\nlet searchResults = [];\r\n\r\nrefs.searchForm.addEventListener('submit', onSearchSubmit)\r\nrefs.gallery.addEventListener('click', onGalleryClick)\r\n\r\nfunction onSearchSubmit (e) {\r\n  e.preventDefault();\r\n\r\n  searchApiService.resetPage();\r\n  searchApiService.query = e.currentTarget.elements.query.value;\r\n  refs.gallery.innerHTML = '';\r\n  refs.endOfSearch.classList.add('is-hidden');\r\n  \r\n   if (searchApiService.query === '') {\r\n    refs.gallery.innerHTML = ''\r\n    stopSearch();\r\n    return showErrorAlert();\r\n  } else {\r\n    searchResults = [];\r\n    searchPictures();\r\n  }\r\n   \r\n}\r\n\r\nasync function fetchPictures() {\r\n  try {\r\n   const response = await searchApiService.fetchImages();\r\n   const items = response.hits;\r\n   searchResults.push(...items);\r\n   return items;\r\n  }\r\n   catch (err) {\r\n      onFetchResults(err);\r\n    }   \r\n   \r\n}\r\n\r\nfunction onFetchResults (items) {\r\n  \r\n  if (items === undefined && searchResults.length > 0) {\r\n    stopSearch();\r\n    refs.endOfSearch.classList.remove('is-hidden')\r\n  } \r\n  else if (items === undefined && searchResults === 0) {\r\n    refs.scrollFlag.classList.add('is-hidden')\r\n    return showErrorAlert();\r\n  }\r\n  else if (items.length === 12) {\r\n    refs.gallery.insertAdjacentHTML('beforeend', galleryItemTemplate(items));\r\n    refs.scrollFlag.classList.remove('is-hidden')\r\n    observer.observe(refs.scrollFlag);\r\n  } \r\n  else if (items.length < 12 && items.length > 0 && searchResults.length > 0){\r\n    refs.gallery.insertAdjacentHTML('beforeend', galleryItemTemplate(items));\r\n    stopSearch();\r\n    refs.endOfSearch.classList.remove('is-hidden')\r\n  } \r\n  else if (items.length === 0 && searchResults.length === 0) {\r\n    showErrorAlert();\r\n    refs.endOfSearch.classList.add('is-hidden')\r\n  }\r\n}\r\n\r\nasync function searchPictures () {\r\n  const items = await fetchPictures();\r\n    onFetchResults(items);\r\n}\r\n\r\nfunction stopSearch () {\r\n  observer.unobserve(refs.scrollFlag)\r\n  refs.scrollFlag.classList.add('is-hidden');\r\n}\r\n\r\nfunction showErrorAlert () {\r\n  defaults.closer = false;\r\n  defaults.sticker = false;\r\n  defaults.width = '300px';\r\n  defaults.delay = 800;\r\n\r\n  error ({\r\n    text: 'Ups. Something went wrong. Try to check spelling.',\r\n  });\r\n}\r\n\r\nfunction onGalleryClick (e) {\r\n \r\n  if (!e.target.classList.contains('gallery_image')){\r\n    return;\r\n   } \r\n      \r\n   let currentImgSrcObj = searchResults.find(\r\n     ({webformatURL})=>webformatURL === e.target.getAttribute('src'));\r\n\r\n   basicLightbox.create(`<img src=${currentImgSrcObj.largeImageURL} alt='${currentImgSrcObj.tags}' class=\"basicLightbox-image\">`).show();\r\n\r\n}\r\n\r\naddBackToTop({backgroundColor: '#70cceb'});\r\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"card-photo\\\">\\r\\n  <div class=\\\"photo-card\\\">\\r\\n    <img src=\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \" alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" class=\\\"gallery_image\\\" />\\r\\n\\r\\n    <div class=\\\"stats\\\">\\r\\n      <p class=\\\"stats-item\\\">\\r\\n        <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n        \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\r\\n      </p>\\r\\n      <p class=\\\"stats-item\\\">\\r\\n        <i class=\\\"material-icons\\\">visibility</i>\\r\\n        \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\r\\n      </p>\\r\\n      <p class=\\\"stats-item\\\">\\r\\n        <i class=\\\"material-icons\\\">comment</i>\\r\\n        \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\r\\n      </p>\\r\\n      <p class=\\\"stats-item\\\">\\r\\n        <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n        \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\r\\n      </p>\\r\\n    </div>\\r\\n  </div>\\r\\n</li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":26,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}